<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Update pkgdown.offline • pkgdown.offline</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Update pkgdown.offline">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pkgdown.offline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pkgdown.offline.html">Use pkgdown.offline</a></li>
    <li><a class="dropdown-item" href="../articles/update.html">Update pkgdown.offline</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nanxstats/pkgdown.offline/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Update pkgdown.offline</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nanxstats/pkgdown.offline/blob/main/vignettes/update.Rmd" class="external-link"><code>vignettes/update.Rmd</code></a></small>
      <div class="d-none name"><code>update.Rmd</code></div>
    </div>

    
    
<p><strong>This vignette is intended for pkgdown.offline developers
only.</strong></p>
<div class="section level2">
<h2 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>pkgdown.offline retrieves the cached frontend dependencies from each
pkgdown version (&gt;= 2.1.0) and bundle them in the package. The cache
is then used by the functions like
<code><a href="../reference/init_site.html">pkgdown.offline::init_site()</a></code> and
<code><a href="../reference/build_site.html">pkgdown.offline::build_site()</a></code> to support offline build
workflows.</p>
<p>Every time a new pkgdown version is released on CRAN, the new version
support should to be verified and potentially added by the
pkgdown.offline developer. pkgdown.offline also optimizes its package
size by deduplicating these cache files across different pkgdown
versions.</p>
</div>
<div class="section level2">
<h2 id="retrieve-raw-pkgdown-external-dependencies">Retrieve raw pkgdown external dependencies<a class="anchor" aria-label="anchor" href="#retrieve-raw-pkgdown-external-dependencies"></a>
</h2>
<p>Open the package in development mode. Retrieve the raw pkgdown
external dependencies cache for all supported pkgdown versions. For
example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_cache</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pkgdown.offline"</span><span class="op">)</span></span>
<span><span class="fu">pkgdown.offline</span><span class="fu">:::</span><span class="fu">update_cache</span><span class="op">(</span><span class="st">"2.1.0"</span>, destdir <span class="op">=</span> <span class="va">path_cache</span><span class="op">)</span></span>
<span><span class="fu">pkgdown.offline</span><span class="fu">:::</span><span class="fu">update_cache</span><span class="op">(</span><span class="st">"2.1.1"</span>, destdir <span class="op">=</span> <span class="va">path_cache</span><span class="op">)</span></span>
<span><span class="fu">pkgdown.offline</span><span class="fu">:::</span><span class="fu">update_cache</span><span class="op">(</span><span class="st">"2.1.2"</span>, destdir <span class="op">=</span> <span class="va">path_cache</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-minified-cache">Create minified cache<a class="anchor" aria-label="anchor" href="#create-minified-cache"></a>
</h2>
<p>Create a minified cache in pkgdown.offline:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pkgdown.offline</span><span class="fu">:::</span><span class="fu">minify_cache</span><span class="op">(</span><span class="va">path_cache</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="update-offline-build-logic">Update offline build logic<a class="anchor" aria-label="anchor" href="#update-offline-build-logic"></a>
</h2>
<p>Now the package contains the minified cache with deduplicated files
in <code>inst/cache/</code>. Commit and push.</p>
<p>Certain internet-skipping logic in
<code><a href="../reference/build_site.html">pkgdown.offline::build_site()</a></code> and relevant functions might
need adjustments.</p>
</div>
<div class="section level2">
<h2 id="using-the-bundled-cache">Using the bundled cache<a class="anchor" aria-label="anchor" href="#using-the-bundled-cache"></a>
</h2>
<p>When <code><a href="../reference/init_site.html">pkgdown.offline::init_site()</a></code> or
<code><a href="../reference/build_site.html">pkgdown.offline::build_site()</a></code> is called to initialize or
build site offline, the <code>copy_to_cache()</code> function will use
<code>restore_cache()</code> to restore the cache into their original
structure to the regular pkgdown cache location that individual pkgdown
versions expect.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nan Xiao, John Blischak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
